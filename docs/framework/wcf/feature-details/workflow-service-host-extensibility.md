---
title: "워크플로 서비스 호스트 확장명"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: c0e8f7bb-cb13-49ec-852f-b85d7c23972f
caps.latest.revision: "14"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: 36ecde17986425436e17e6b7a4043fc74a6e583e
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 11/21/2017
---
# <a name="workflow-service-host-extensibility"></a><span data-ttu-id="da27e-102">워크플로 서비스 호스트 확장명</span><span class="sxs-lookup"><span data-stu-id="da27e-102">Workflow Service Host Extensibility</span></span>
[!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)]<span data-ttu-id="da27e-103">에서는 워크플로 서비스를 호스트하는 <xref:System.ServiceModel.Activities.WorkflowServiceHost> 클래스를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-103"> provides the <xref:System.ServiceModel.Activities.WorkflowServiceHost> class for hosting workflow services.</span></span> <span data-ttu-id="da27e-104">이 클래스는 관리되는 응용 프로그램의 워크플로 서비스나 Windows 서비스를 자체 호스트할 때 사용되며,</span><span class="sxs-lookup"><span data-stu-id="da27e-104">This class is used when you are self-hosting a workflow service in a managed application or a Windows service.</span></span> <span data-ttu-id="da27e-105">IIS(인터넷 정보 서비스) 또는 WAS(Windows Process Activation Service)에서 워크플로 서비스를 호스트할 때도 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-105">This class is also used when hosting a workflow service with Internet Information Services (IIS) or Windows Process Activation Service (WAS).</span></span> <span data-ttu-id="da27e-106"><xref:System.ServiceModel.Activities.WorkflowServiceHost> 클래스는 사용자 지정 확장을 추가하고, 유휴 동작을 변경하고, 서비스가 아닌 워크플로(메시징 작업을 사용하지 않는 워크플로)를 호스트할 수 있는 확장 지점을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-106">The <xref:System.ServiceModel.Activities.WorkflowServiceHost> class provides extension points that allow you to add custom extensions, change the idle behavior, and host non-service workflows (workflows that do not use messaging activities).</span></span>  
  
## <a name="workflow-service-host-extensions"></a><span data-ttu-id="da27e-107">워크플로 서비스 호스트 확장</span><span class="sxs-lookup"><span data-stu-id="da27e-107">Workflow Service Host Extensions</span></span>  
 <span data-ttu-id="da27e-108"><xref:System.ServiceModel.Activities.WorkflowServiceHost>에는 <xref:System.ServiceModel.Activities.WorkflowServiceHost.WorkflowExtensions%2A>에 확장을 추가하는 메서드를 제공하는 <xref:System.Activities.Hosting.WorkflowInstanceExtensionManager> 형식의 <xref:System.ServiceModel.Activities.WorkflowServiceHost> 속성이 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-108">The <xref:System.ServiceModel.Activities.WorkflowServiceHost> contains a <xref:System.ServiceModel.Activities.WorkflowServiceHost.WorkflowExtensions%2A> property of type <xref:System.Activities.Hosting.WorkflowInstanceExtensionManager> that provides methods to add extensions to the <xref:System.ServiceModel.Activities.WorkflowServiceHost>.</span></span> <span data-ttu-id="da27e-109"><xref:System.Activities.Hosting.WorkflowInstanceExtensionManager.Add%2A> 메서드를 사용하면 각 워크플로 서비스 인스턴스에 대한 확장을 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-109">Use the <xref:System.Activities.Hosting.WorkflowInstanceExtensionManager.Add%2A> method to add an extension for each workflow service instance.</span></span> <span data-ttu-id="da27e-110">워크플로 서비스 인스턴스를 만들거나 지속성 저장소에서 로드하면 새 확장을 만들기 위해 지정된 대리자가 호출됩니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-110">The delegate specified is called to create a new extension when a workflow service instance is created or loaded from a persistence store.</span></span> <span data-ttu-id="da27e-111"><xref:System.Activities.Hosting.WorkflowInstanceExtensionManager.Add%2A> 메서드를 사용하면 각 워크플로 서비스 호스트에 대한 확장을 추가할 수 있습니다. 모든 워크플로 서비스 인스턴스에서 하나의 확장 인스턴스를 공유합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-111">Use the <xref:System.Activities.Hosting.WorkflowInstanceExtensionManager.Add%2A> method to add an extension for each workflow service host, one instance of the extension is shared for all workflow service instances.</span></span>  
  
## <a name="react-to-unhandled-exceptions"></a><span data-ttu-id="da27e-112">처리되지 않은 예외에 응답</span><span class="sxs-lookup"><span data-stu-id="da27e-112">React to Unhandled Exceptions</span></span>  
 <span data-ttu-id="da27e-113"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior>를 사용하면 워크플로 서비스 내에서 처리되지 않은 예외가 발생할 경우 수행할 동작을 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-113">The <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior> enables you to specify the action to take if an unhandled exception occurs within a workflow service.</span></span> <span data-ttu-id="da27e-114"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior.Action%2A> 속성은 다음 <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction> 값 중 하나를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-114">The <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior.Action%2A> property specifies one of the <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction> values:</span></span>  
  
-   <span data-ttu-id="da27e-115"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Abandon> – 워크플로 서비스 인스턴스를 중단합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-115"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Abandon> – Aborts the workflow service instance.</span></span>  
  
-   <span data-ttu-id="da27e-116"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.AbandonAndSuspend> – 마지막으로 지속된 상태로 롤백하고 워크플로 서비스 인스턴스를 일시 중단합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-116"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.AbandonAndSuspend> – Rolls back to the last persisted state and suspends the workflow service instance.</span></span> <span data-ttu-id="da27e-117">이는 워크플로가 이미 한 번 이상 지속된 경우에만 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-117">This only occurs if the workflow has already been persisted at least once.</span></span> <span data-ttu-id="da27e-118">그렇지 않은 경우 워크플로 인스턴스가 중단됩니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-118">If not the workflow instance is aborted.</span></span>  
  
-   <span data-ttu-id="da27e-119"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Cancel> – 인스턴스를 취소합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-119"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Cancel> – Cancels the instance.</span></span>  
  
-   <span data-ttu-id="da27e-120"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Terminate> – 인스턴스를 종료합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-120"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Terminate> – Terminates the instance.</span></span>  
  
 <span data-ttu-id="da27e-121">이 동작은 다음 예제와 같이 코드에서 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-121">This behavior can be configured in code as shown in the following example.</span></span>  
  
```csharp  
host.Description.Behaviors.Add(new WorkflowUnhandledExceptionBehavior { Action = WorkflowUnhandledExceptionAction.Abandon });  
```  
  
 <span data-ttu-id="da27e-122">또한 다음 예제와 같이 구성 파일에서 이 동작을 구성할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-122">It can also be configured in a configuration file as shown in the following example.</span></span>  
  
```xml
<behaviors>  
      <serviceBehaviors>  
        <behavior>  
          <serviceMetadata httpGetEnabled="True"/>  
          <serviceDebug includeExceptionDetailInFaults="False" />  
          <workflowUnhandledExceptionBehavior action="Abandon" />        
        </behavior>  
      </serviceBehaviors>  
```  
  
## <a name="hosting-non-service-workflows"></a><span data-ttu-id="da27e-123">서비스가 아닌 워크플로 호스팅</span><span class="sxs-lookup"><span data-stu-id="da27e-123">Hosting Non-Service Workflows</span></span>  
 <span data-ttu-id="da27e-124"><xref:System.ServiceModel.Activities.WorkflowServiceHost>를 사용하여 서비스가 아닌 워크플로, <xref:System.ServiceModel.Activities.Receive> 작업으로 시작하지 않는 워크플로 또는 메시징 작업을 사용하지 않는 워크플로를 호스트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-124"><xref:System.ServiceModel.Activities.WorkflowServiceHost> can be used to host non-service workflows, or workflows that either do not begin with a <xref:System.ServiceModel.Activities.Receive> activity or workflows that do not use the messaging activities.</span></span> <span data-ttu-id="da27e-125">일반적으로 워크플로 서비스는 <xref:System.ServiceModel.Activities.Receive> 작업으로 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-125">Workflow services normally begin with a <xref:System.ServiceModel.Activities.Receive> activity.</span></span> <span data-ttu-id="da27e-126"><xref:System.ServiceModel.Activities.WorkflowServiceHost>가 워크플로 서비스에 대한 메시지를 받을 때 실행 중이거나 지속된 워크플로 서비스가 없으면 새 워크플로 서비스 인스턴스가 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-126">When the <xref:System.ServiceModel.Activities.WorkflowServiceHost> receives a message for a workflow service, if it is not already running (or persisted) a new workflow service instance is created.</span></span> <span data-ttu-id="da27e-127">워크플로가 받기 작업으로 시작하지 않으면 메시지를 받는 작업이 없기 때문에 메시지를 보내도 워크플로가 시작되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-127">If a workflow does not begin with a Receive activity, it cannot be started by sending a message because there is no activity to receive the message.</span></span> <span data-ttu-id="da27e-128">서비스가 아닌 워크플로를 호스트하려면 <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint>에서 클래스를 파생시키고 <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetInstanceId%2A>, <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetCreationContext%2A> 및 <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnResolveBookmark%2A>를 재정의합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-128">To host a non-service workflow, derive a class from <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint> and override <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetInstanceId%2A>, <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetCreationContext%2A>, and <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnResolveBookmark%2A>.</span></span> <span data-ttu-id="da27e-129">원하는 인스턴스 ID를 제공하려면 <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetInstanceId%2A>를 재정의합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-129">Override <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetInstanceId%2A> if you want to provide a preferred instance ID.</span></span> <span data-ttu-id="da27e-130">사용자 지정 워크플로 생성 컨텍스트를 만들거나 기존 <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetCreationContext%2A>의 인스턴스를 채우려면 <xref:System.ServiceModel.Activities.WorkflowCreationContext>를 재정의합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-130">Override <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetCreationContext%2A> to create a custom workflow creation context or populate an instance of the existing <xref:System.ServiceModel.Activities.WorkflowCreationContext>.</span></span> <span data-ttu-id="da27e-131">들어오는 메시지에서 책갈피를 수동으로 추출하려면 <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnResolveBookmark%2A>를 재정의합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-131">Override <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnResolveBookmark%2A> to manually extract the bookmark from the incoming message.</span></span> <span data-ttu-id="da27e-132">이 메서드를 재정의하는 경우 WorkflowHostingEndpoint에 전송된 메시지에 응답하도록 메시지 본문에서 <xref:System.ServiceModel.Activities.WorkflowHostingResponseContext.SendResponse%2A>를 호출해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-132">If you override this method, you must invoke <xref:System.ServiceModel.Activities.WorkflowHostingResponseContext.SendResponse%2A> in its body so as to respond to the message sent to the WorkflowHostingEndpoint.</span></span> <span data-ttu-id="da27e-133">이렇게 하지 않으면 <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentCalls%2A> 제한을 결국 초과할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-133">If you do not do so, a <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentCalls%2A> limit may be eventually exceeded.</span></span> <span data-ttu-id="da27e-134">양방향 계약에서는 클라이언트가 응답을 받지 못하기 때문에 <xref:System.ServiceModel.Activities.WorkflowHostingResponseContext.SendResponse%2A> 호출 실패를 감지할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-134">In two-way contracts, you may be able to detect your   failure to invoke <xref:System.ServiceModel.Activities.WorkflowHostingResponseContext.SendResponse%2A> because of the client’s failure to receive a response.</span></span> <span data-ttu-id="da27e-135">단방향 계약에서는 <xref:System.ServiceModel.Activities.WorkflowHostingResponseContext.SendResponse%2A> 스로틀 제한이 초과된 후 너무 늦을 때까지 <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentCalls%2A> 호출 실패 실수를 인식하지 못할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-135">In one-way contracts, you may not recognize the mistake of failing to call <xref:System.ServiceModel.Activities.WorkflowHostingResponseContext.SendResponse%2A> until it’s too late, after the <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentCalls%2A> throttle limit is exceeded.</span></span> <span data-ttu-id="da27e-136">자세한 내용은 참조 하십시오는 [WorkflowHostingEndpoint 다시 시작 책갈피](../../../../docs/framework/windows-workflow-foundation/samples/workflowhostingendpoint-resume-bookmark.md)서비스가 아닌 워크플로의 새 인스턴스를 만들려면 새 인스턴스를 만드는 작업을 정의 하는 서비스 계약을 선언 합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-136">For more information, please see the [WorkflowHostingEndpoint Resume Bookmark](../../../../docs/framework/windows-workflow-foundation/samples/workflowhostingendpoint-resume-bookmark.md)To create a new instance of a non-service workflow, declare a service contract that defines an operation that creates a new instance.</span></span> <span data-ttu-id="da27e-137">만들기 작업이 IDictionary 취해야\<문자열, o b j > 워크플로 매개 변수를 필요한 하나도 통과 하도록 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-137">The creation operation should take an IDictionary\<string, object> to pass any required workflow parameters.</span></span> <span data-ttu-id="da27e-138">이 계약은 <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint> 파생 클래스에 의해 암시적으로 구현됩니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-138">This contract is implicitly implemented by the <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint>-derived class.</span></span> <span data-ttu-id="da27e-139">인스턴스를 추가 하는 워크플로 호스팅하는 경우는 <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint>-파생 클래스를 호출 하 여 <xref:System.ServiceModel.Activities.WorkflowServiceHost.AddServiceEndpoint%2A> 호출 <!--zz xref:System.ServiceModel.Activities.WorkflowServiceHost.Open%2A--> `System.ServiceModel.Activities.WorkflowServiceHost.Open`합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-139">When hosting the workflow, add an instance of the <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint>-derived class to the host by calling <xref:System.ServiceModel.Activities.WorkflowServiceHost.AddServiceEndpoint%2A> and call <!--zz xref:System.ServiceModel.Activities.WorkflowServiceHost.Open%2A--> `System.ServiceModel.Activities.WorkflowServiceHost.Open`.</span></span> <span data-ttu-id="da27e-140">워크플로의 인스턴스를 만들려면 서비스 계약 형식의 <xref:System.ServiceModel.ChannelFactory%601>를 만들고 <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A>를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-140">To create an instance of the workflow, create a <xref:System.ServiceModel.ChannelFactory%601> of your service contract type and call <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A>.</span></span> <span data-ttu-id="da27e-141">그러면 서비스 계약에 정의된 만들기 작업을 호출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da27e-141">You can then call the create operation defined in your service contract.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="da27e-142">참고 항목</span><span class="sxs-lookup"><span data-stu-id="da27e-142">See Also</span></span>  
 [<span data-ttu-id="da27e-143">워크플로 서비스</span><span class="sxs-lookup"><span data-stu-id="da27e-143">Workflow Services</span></span>](../../../../docs/framework/wcf/feature-details/workflow-services.md)  
 [<span data-ttu-id="da27e-144">메시징 활동</span><span class="sxs-lookup"><span data-stu-id="da27e-144">Messaging Activities</span></span>](../../../../docs/framework/wcf/feature-details/messaging-activities.md)
